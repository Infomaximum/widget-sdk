/**
 * Описывает stateful-рантайм с жизненным циклом.
 *
 * Порядок фаз:
 * initialize -> mount -> update* -> unmount
 *
 * Гарантируется строгая последовательность вызовов.
 */
export interface ILifecycleRuntime<Props> {
  /**
   * Вызывается один раз перед mount.
   *
   * Предназначен для подготовки среды выполнения рантайма:
   * - выделение ресурсов
   * - создание внутренних структур
   * - инициализация rendering engine
   *
   * Допускаются структурные изменения контейнера,
   * не приводящие к фактическому отображению UI.
   */
  initialize(container: HTMLElement): void;

  /**
   * Активирует рантайм и запускает отображение UI.
   *
   * После вызова mount рантайм считается видимым пользователю.
   */
  mount(container: HTMLElement, props: Props): void;

  /** Синхронизирует состояние рантайма с новыми props */
  update(container: HTMLElement, props: Props): void;

  /**
   * Вызывается при размонтировании.
   *
   * Должен:
   * - удалить DOM-узлы
   * - отписаться от событий
   * - освободить ресурсы
   */
  unmount(container: HTMLElement): void;
}

/**
 * Фабрика создания рантайма.
 *
 * Передаётся вместо готового экземпляра, чтобы среда выполнения
 * могла самостоятельно управлять жизненным циклом и гарантировать
 * создание отдельного instance для каждого использования.
 */
export interface ILifecycleRuntimeFactory<Props> {
  (): ILifecycleRuntime<Props>;
}
